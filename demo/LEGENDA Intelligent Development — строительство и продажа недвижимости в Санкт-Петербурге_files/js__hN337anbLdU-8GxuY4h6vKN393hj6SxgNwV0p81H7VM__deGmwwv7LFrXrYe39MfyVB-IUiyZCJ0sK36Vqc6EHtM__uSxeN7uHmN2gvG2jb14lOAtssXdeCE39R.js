/* Source and licensing information for the line(s) below can be found at http://legenda-dom.ru/sites/all/modules/legenda/js/miniZoomPan.js. */

jQuery.fn.miniZoomPan=function(settings){settings=jQuery.extend({sW:10,sH:10,lW:20,lH:20,frameColor:"#cecece",frameWidth:1,loaderContent:"loading..."},settings);return this.each(function(){var div=jQuery(this);div.css({width:settings.sW,height:settings.sH,border:settings.frameWidth+"px solid "+settings.frameColor}).addClass("minizoompan");var ig=div.children();ig.css({position:"relative"});jQuery(window).bind("load",function(){});div.css({overflow:"hidden"});div.mousemove(function(e){var divWidth=div.width();var divHeight=div.height();var igW=ig.width();var igH=ig.height();var dOs=div.offset();var leftPan=(igW<=divWidth)?0:(e.pageX-dOs.left)*(divWidth-igW)/(divWidth+settings.frameWidth*2);var topPan=(igH<=divHeight)?((divHeight+settings.frameWidth*2-igH)/2):(e.pageY-dOs.top)*(divHeight-igH)/(divHeight+settings.frameWidth*2);ig.css({left:leftPan,top:topPan});});});};;
/* Source and licensing information for the above line(s) can be found at http://legenda-dom.ru/sites/all/modules/legenda/js/miniZoomPan.js. */
/* Source and licensing information for the line(s) below can be found at http://legenda-dom.ru/sites/all/themes/legenda_dom_ru/js/_primary.js. */

var $filterResultsHolder='';var smt=null;var okay=true;var currentUrl='';var cb=null;var capHeight=0;var isPopupOpen=false;var detailedShow=false;var caller=null;var isAlwaysOnTop=true;var isDeveloper=false;var pageX=0;var pageY=0;var closingPopups=false;var ajaxInProgress=false;var currentMouseHover=null;var frontslidesready=0;var pobedabgready=0;var alreadyrun=new Array();var liveTex=true,liveTexID=29624,liveTex_object=true;liveSettings={"account_id":33185,"chat_open":false,"embed_chat":0,"flag_mobile":1,"flag_activate":1,"account_enable_lid":1,"site_enable_lid":1,"lid_color":3,"lid_question":0,"lid_face":"","lid_face_type":0,"id_site":"29624","cServer2":"http:\/\/cs15.livetex.ru\/","jarl":{"custom_lead":{"back_bg_lead":"","jarl_lead_w":0,"jarl_lead_h":0,"jarl_lead":""},"id":"liveTextLabel_19682","type_size":2,"color":3,"url":"none","offset":200,"offset_type":0,"size":398,"el":{"back":{"bg":"http:\/\/cs15.livetex.ru\/b8503cef922e31240a69790191f75684.png","bg_close":"none","h":334,"w":362},"jarl":{"bg":"http:\/\/cs15.livetex.ru\/a3da88e9396dc6a34646c48bb41ddf04.png","bgoff":"http:\/\/cs15.livetex.ru\/b00e8faa750cbc1e6b3a3e0e71365f90.png","w":40,"h":192,"t":12,"l":0},"oper":{"border":"http:\/\/cs15.livetex.ru\/6ee2895eb005a81621e2fcbcac2b10ea.png","w":60,"h":70,"t":24,"l":64,"text":{"name":{"color":"#ffffff","size":"18px"},"depart":{"color":"#ffffff","size":"13px"}}},"say":{"bg":"http:\/\/cs15.livetex.ru\/9cd28286548498fbc5d8cfe8d35a3159.png","w":321,"h":102,"t":83,"l":61,"text":{"t":114,"l":75,"color":"#111f37","size":"14px"}},"textarea":{"bg":"http:\/\/cs15.livetex.ru\/88a158f8a1b13478c40ed22695cf35d1.png","t":200,"l":61,"w":321,"h":75},"cancel":{"b":24,"l":160,"string":"      ,               !","color":"#ffffff","size":"14px"},"button":{"bg":"http:\/\/cs15.livetex.ru\/7bf31cbdf5037231be044314d0e6bb75.png","hover":"http:\/\/cs15.livetex.ru\/edeed85fdc0942d9a2f319f3c4d52aaa.png","push":"http:\/\/cs15.livetex.ru\/bacde9818a55862c46f288a5dd3e03a1.png","b":14,"l":265,"w":116,"h":38}},"flag_animate":2,"flag_hide_offline":false,"position":"right"},"auto":[{"id":42548,"flag_lid":0,"settings":{"time_sec_all":300,"no_chat":1,"once":"true","max_show":2},"oper":{"say":"                        ,                                                     ,                                                     !","lid_submit_text":"              !                                       "},"is_active":false,"is_activated":false,"group_id":1,"member_id":1,"location":[]},{"id":94015,"flag_lid":1,"settings":{"once":"true","time_sec_all":60,"no_chat":1},"oper":{"say":"                                                           ,                                                                                 ","lid_submit_text":"              !                                       "},"is_active":false,"is_activated":false,"group_id":1,"member_id":1,"location":[]},{"id":42549,"flag_lid":0,"settings":{"max_show":2,"once":"true","no_chat":1,"countpage":2},"oper":{"say":"                        ,                                                     ,                                                     !","lid_submit_text":"              !                                       "},"is_active":false,"is_activated":false,"group_id":1,"member_id":1,"location":[]},{"id":94016,"flag_lid":1,"settings":{"no_chat":1,"once":"true","countpage":5},"oper":{"say":"                                                           ,                                                                                 ","lid_submit_text":"              !                                       "},"is_active":false,"is_activated":false,"group_id":1,"member_id":1,"location":[]}],"buttons":[{"id":"liveTexButton_20665","voice":0,"member_id":1,"group_id":1,"url":"","online":"3745c22ac199ca1d9795e9e0e41244ba.jpeg","offline":"d0070b17481d90de1de17b2e280858e5.jpeg","border":"0","width":146,"height":50,"foto_w":60,"foto_h":70,"border_w":0,"border_h":0,"namet":0,"namel":0,"departt":0,"departl":0,"color":"0","offcolor":"0","names":"0","departs":"0","custom":true,"custom_def_w":null,"custom_def_h":null,"bcolor":3,"bsize":1,"custom_on":"3745c22ac199ca1d9795e9e0e41244ba.jpeg","custom_off":"d0070b17481d90de1de17b2e280858e5.jpeg","do_welcome":0,"flag_site":true,"flag_group":false,"flag_member":false,"flag_custom":1,"customSettings":{"custom_w":106,"custom_h":26,"custom_woff":106,"custom_hoff":26}}]};var _gaq=_gaq||[];var isMobile={Android:function(){return navigator.userAgent.match(/Android/i)?true:false;},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)?true:false;},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)?true:false;},Windows:function(){return navigator.userAgent.match(/IEMobile/i)?true:false;},any:function(){return(isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Windows());}};(function($){jQuery.cachedScript=function(url,options){options=$.extend(options||{},{dataType:"script",cache:true,url:url});return jQuery.ajax(options);};liveTexStarter=function(){};doubleClickStarter=function(){_gaq.push(['_setAccount','UA-32756002-1']);_gaq.push(['_setDomainName','legenda-dom.ru']);_gaq.push(['_setAllowLinker()',true]);_gaq.push(['_trackPageview']);};adhandsStarter=function(){};kavangaStarter=function(){var kref='';try{kref=escape(document.referrer);}catch(e){};var d=document,b=document.body;var img=d.createElement('IMG');with(img.style){position='absolute';width='0px';height='0px';}
img.src=('https:'==document.location.protocol?'https://':'http://')+'b.kavanga.ru/exp?sid=5043&bt=3&bn=1&ct=8&prr='+kref+'&rnd='+Math.round(Math.random()*1000000);b.insertBefore(img,b.firstChild);};yaStarter=function(){try{window.yaCounter18274483=new Ya.Metrika({id:18274483,webvisor:true,clickmap:true,trackLinks:true,accurateTrackBounce:true,trackHash:true});}catch(e){}};initTabs=function(){var sets=document.getElementsByTagName("ul");for(var i=0;i<sets.length;i++)
{if(sets[i].className.indexOf("tabset")!=-1)
{var tabs=[];var links=sets[i].getElementsByTagName("a");for(var j=0;j<links.length;j++)
{if(links[j].className.indexOf("tab")!=-1)
{tabs.push(links[j]);links[j].tabs=tabs;var c=document.getElementById(links[j].href.substr(links[j].href.indexOf("#")+1));if(c)if(links[j].className.indexOf("active")!=-1)c.style.display="block";else c.style.display="none";links[j].onclick=function()
{var c=document.getElementById(this.href.substr(this.href.indexOf("#")+1));if(c)
{for(var i=0;i<this.tabs.length;i++)
{var tab=document.getElementById(this.tabs[i].href.substr(this.tabs[i].href.indexOf("#")+1));if(tab)
{tab.style.display="none";}
this.tabs[i].className=this.tabs[i].className.replace("active","");}
this.className+=" active";c.style.display="block";try{if($('ul.tabset a.active').attr('href').indexOf('#plan-tab')!=-1){POS[9].yspan=sk*990;if(kr>0.87)
POS[9].yspan=sk*1050;}
else if($('ul.tabset a.active').attr('href').indexOf('house-tab')!=-1){initBParams();}}
catch(e)
{}
return false;}}}}}}};clearPopups=function(){if(currentMouseHover&&$('ul.tabset a.active').length&&$('ul.tabset a.active').attr('href').indexOf('#plan-tab')==-1){$(".active").filter(".b-holder").each(function(){if($(currentMouseHover).parents().index($(this).parent())==-1){var that=$(this);var cHeight=that.parent().children("div.inactive").height();var lastHeight=that.height();that.parent().children("div.active").css('top',(-1)*cHeight);that.parent().children("div.inactive").fadeIn(50);that.fadeOut(100);}});}
setTimeout(clearPopups,500);}
openPopup=function(cid)
{if(cid=="popup-web-cam"){}
if(!document.getElementById(cid))
return false;isPopupOpen=true;smt=scrollMaster.onScrolling;scrollMaster.onScrolling=function(){return false};$("#"+cid).fadeIn(500);$("#"+cid).find(".popup_inner").fadeIn(500);mCustomScrollbars($("#"+cid).find(".popup_inner").attr('id'));setTimeout(ics,1000,cid);setTimeout(ics,2000,cid);setTimeout(ics,3000,cid);document.body.style.overflow="hidden";}
ics=function(cid){mCustomScrollbars($("#"+cid).find(".popup_inner").attr('id'));CustomScroller("resize");}
getPopupFromId=function(popup)
{var cid=popup;switch(popup){case'view':cid='view-from';break;case'architecture':cid='replica';break;case'materials':cid='mats';break;case'environment':cid='enviro';break;case'publiczones':cid='public-zones';break;case'situation':cid='build-plan';case'camera':cid='web-cam';break;}
return cid;}
getIdFromPopup=function(popup)
{var cid=popup;switch(popup){case'view-from':cid='view';break;case'replica':cid='architecture';break;case'mats':cid='materials';break;case'enviro':cid='environment';break;case'public-zones':cid='publiczones';break;case'build-plan':cid='situation';break;case'web-cam':cid='camera';break;}
return cid;}
checkPopup=function()
{try{var url=window.location+'';var popup=url.split('#')[1];cid=getPopupFromId(popup);$("#wrapper").show();openPopup('popup-'+cid);}
catch(e)
{}}
drawCoord=function(){var pStyle='style="float:right;width:160px;background:#fff;padding:16px 0 17px;margin:10px 0 0;"';$('<li id="coord-link"><p '+pStyle+'><span id="x-coord">x: 0</span></p><p '+pStyle+'><span id="y-coord">y: 0</span></p></li>').appendTo('.plan-nav');$("#coord-link").hide();}
initAllApt=function(){$(window).unload(function(){$(window).scrollTop(0);});currentUrl=((window.location+'').split('#').length>1)?(window.location+'').split('#')[0]:(window.location+'');$(".popup_inner").each(function(){$(this).css("height",$(window).height()-100);});$(".popup_inner .dragger_container").each(function(){$(this).css("height",$(this).parent().parent().height()-120);});$("div.big, .info-box").click(function(){var cid=$(this).attr('id')+'-big';openPopup(cid);return false;});$.ctrl=function(key,callback,args){var isCtrl=false;var isAlt=false;$(document).keydown(function(e){if(!args)args=[];if(e.ctrlKey)isCtrl=true;if(e.altKey)isAlt=true;var kc=parseInt(key);if((!isNaN(kc)&&kc>0&&e.keyCode==key||isNaN(kc)&&e.keyCode==key.charCodeAt(0))&&isCtrl&&isAlt){callback.apply(this,args);return false;}}).keyup(function(e){if(e.ctrlKey)isCtrl=false;if(e.altKey)isAlt=false;});};$.ctrl(68,function(){if(!isDeveloper){isDeveloper=true;$("#coord-link").show();$('.plan').css('cursor','crosshair');}else{isDeveloper=false;$("#coord-link").hide();$('.plan').css('cursor','url("http://legenda-dom.ru/sites/all/themes/legenda_dom_ru/cursor/zoom.cur") 20 20, url("../cursor/zoom.cur") 20 20, default');}
return false;});$(".sz").click(function(event){if(closingPopups)
return true;if($(event.target).parents().index($('.ico-info'))==-1&&$(event.target).parents().index($('.info-popup'))==-1){if(isDeveloper){pageX=event.pageX-$(".plan").offset().left;pageY=event.pageY-$(".plan").offset().top;$('#x-coord').html('x: '+pageX);$('#y-coord').html('y: '+pageY);}else{$('#superzoom_container').html($('#superzoom-content-'+this.id).html());caller=$('#superzoom_container');$('#superzoom_container').fadeIn(500);pageX=event.pageX;pageY=event.pageY;$("#superzoom_container .zoom-wrapper img").load(function(){szResize();});$(window).resize(function(){szResize();});document.body.style.overflow="hidden";$(".close-btn").click(function(){closePopup($(this));});$("#superzoom_container .zoom-wrapper").click(function(){closePopup($(this));});}}})
$(".close-btn").click(function(){closePopup($(this));});$("#footer .list a").click(function(){var pid=this.href.split('#')[1];if(pid.length>2){window.location="/pobeda#"+pid;return false;}
else
return true;});$(document).click(function(event){if(!isPopupOpen)
return true;var pr=$(event.target).parents();var closePopup=true;for(var i=0;i<pr.length;i++){if(pr[i].className.indexOf('popup')!=-1||pr[i].className.indexOf('tabset')!=-1)
closePopup=false;}
if(closePopup){isPopupOpen=false;document.body.style.overflow="";$('.popup').hide();window.location=currentUrl+"#home";return false;}});$(".detailed-plan a").click(function(){var that=$(this).parent().parent().parent().parent();if(detailedShow){isAlwaysOnTop=true;that.find('.bot').fadeOut(500);detailedShow=false;var cOpacity=(($(window).scrollTop()-320)/500)>1?1:(($(window).scrollTop()-300)/500);that.find('.inner-wrapper').css('background','rgba(255,255,255, '+cOpacity+')');}
else{isAlwaysOnTop=true;that.find('.bot').fadeIn(500);$(window).scroll(function(){alwaysOnTop(that);return true;});detailedShow=true;}
that.toggleClass("active");return false;});$(window).scroll(function(){alwaysOnTop($(".detailed-plan a").parent().parent().parent().parent());return true;});$("a.ico-info").click(function(){$("a.ico-info").removeClass('active');closingPopups=true;$('.info-popup').fadeOut(50);$("#popup-"+this.id.split('-')[1]).fadeIn(500);$(this).addClass('active');return false;});$(document).click(function(event){if($(event.target).parents().index($('.info-popup'))==-1){$('.info-popup').fadeOut(500);$("a.ico-info").removeClass('active');setTimeout(setColsingFalse,500);}});$("a.left, a.right, a.up, a.down, ul.small-plan li a, .apart-nav .bot li a").live('click',function(){var currentHref=$(this).attr('href');if(currentHref&&currentHref!='#'){ajaxRun(currentHref);}
return false;});}
szResize=function(){$("#superzoom_container .zoom-wrapper").miniZoomPan({sW:$("#superzoom_container .zoom-wrapper img").width(),sH:$("#superzoom_container .zoom-wrapper img").height(),lW:$("#superzoom_container .zoom-wrapper img").width(),lH:$("#superzoom_container .zoom-wrapper img").height(),frameWidth:0});$("#superzoom_container .zoom-wrapper").width($(window).width()-143);$("#superzoom_container .zoom-wrapper").height($(window).height()-70);$("#superzoom_container .zoom-content").height($(window).height()-1);var divWidth=$(window).width()-143;var divHeight=$(window).height()-70;var igW=$("#superzoom_container .zoom-wrapper img").width();var igH=$("#superzoom_container .zoom-wrapper img").height();var dOs=$("#superzoom_container .zoom-wrapper").offset();if(igH<=divHeight){$("#superzoom_container .zoom-wrapper img").css('top',(divHeight-igH)/2);}
else{$("#superzoom_container .zoom-wrapper img").css('top',(pageY-dOs.top)*(divHeight-igH)/divHeight);}
if(igW<=divWidth){$("#superzoom_container .zoom-wrapper img").css('left',0);}
else{$("#superzoom_container .zoom-wrapper img").css('left',(pageX-dOs.left)*(divWidth-igW)/divWidth);}}
setColsingFalse=function(){closingPopups=false;}
closePopup=function(that){isPopupOpen=false;if(caller)
caller.fadeOut(500);else
that.parent().parent().parent().fadeOut(500);document.body.style.overflow="";caller=null;return false;}
alwaysOnTop=function(that){if(!isAlwaysOnTop)
return;if($(window).scrollTop()>409){if(!detailedShow){var cOpacity=(($(window).scrollTop()-320)/500)>1?1:(($(window).scrollTop()-300)/500);that.find('.inner-wrapper').css('background','rgba(255,255,255, '+cOpacity+')');}
that.parent().css('padding','120px 0 35px');that.css('position','fixed');that.css('z-index','100');that.css('top','-9px');}
else{that.css('position','relative');that.css('top','0px');that.parent().css('padding','0 0 35px');that.find('.inner-wrapper').css('background','none');}}
ajaxRun=function(link){if(!ajaxInProgress){ajaxInProgress=true;$('#plan-tab').load(link+' div.apartment',function(){initAll();initTabs();if(link!=window.location){window.history.pushState({path:link},'',link);}
$('div.superzoom-ajax-container').load(link+' div.superzoom-ajax-package');alwaysOnTop($(".detailed-plan a").parent().parent().parent().parent());ajaxInProgress=false;});}
return false;}
loadPageApt=function(){$("#wrapper").animate({opacity:'toggle',top:0},1500);}
openPopup=function(cid){isPopupOpen=true;$("#popup-holder").fadeIn(500);$("#popup-holder").find(".popup_inner").fadeIn(500);mCustomScrollbars($("#popup-holder").find(".popup_inner").attr('id'));$("#loading").height($('#mcs_container').height());document.body.style.overflow="hidden";cid+=".html";$.ajax({url:cid,dataType:"html"}).done(function(msg){try{$("#popup-holder").find(".content").html(msg);mCustomScrollbars($("#popup-holder").find(".popup_inner").attr('id'));setTimeout(ics,1000,cid);setTimeout(ics,2000,cid);setTimeout(ics,3000,cid);}
catch(e){}});}
setOkay=function(){okay=true;}
setClicked=function(that){var pe=that.parent().parent().parent();for(var i=0;i<POS.length-1;i++){if(POS[i].el.attr("id")==pe.attr("id")){POS[i].clicked=true;}}}
setPOSActive=function(that){var pe=that.parent().parent().parent();for(var i=0;i<POS.length-1;i++){if(POS[i].el.attr("id")==pe.attr("id")){POS[i].active=POS[i].active?false:true;}}}
blockOpen=function(that)
{if(that.parent().parent().parent().attr('id')=='web-cam1'){that.parent().parent().parent().children("div.active").fadeIn(100);that.parent().parent().hide();}
else{that.parent().parent().parent().children("div.active .act-button").hide();that.parent().parent().children("div.act-button").hide();var lastHeight=that.parent().parent().height();that.parent().parent().parent().children("div.active").css('top',(-1)*that.parent().parent().parent().children("div.active").height());that.parent().parent().animate({height:that.parent().parent().parent().children("div.active").outerHeight()},100,function(){that.parent().parent().parent().children("div.active").fadeIn(100);that.parent().parent().fadeOut(250,function(){that.parent().parent().parent().children("div.active").css('top',0);that.parent().parent().height(lastHeight);that.parent().parent().parent().children("div.active .act-button").show();that.parent().parent().children("div.act-button").show();okay=true;});});}}
blockClose=function(that)
{if(that.parent().parent().parent().attr('id')=='web-cam1'){that.parent().parent().parent().children("div.inactive").fadeIn(100);that.parent().parent().hide();return;}
that.parent().parent().parent().children("div.inactive .act-button").hide();that.parent().parent().children("div.act-button").hide();var cHeight=that.parent().parent().parent().children("div.inactive").height();var lastHeight=that.parent().parent().height();that.parent().parent().stop().animate({height:cHeight},100,function(){that.parent().parent().parent().children("div.active").css('top',(-1)*cHeight);that.parent().parent().parent().children("div.inactive").fadeIn(100);that.parent().parent().fadeOut(250,function(){that.parent().parent().height(lastHeight);that.parent().parent().parent().children("div.inactive .act-button").show();that.parent().parent().children("div.act-button").show();okay=true;});});}
initBlocks=function(hideAll){$("div.b-holder").each(function(){if($(this).hasClass('active'))
$(this).hide();else
hideAll?$(this).hide():$(this).show();});}
checkPos=function(){if($('ul.tabset a.active').attr('href').indexOf('house-tab')!=-1&&okay){for(var i=0;i<POS.length-1;i++){if(i!=9&&!POS[i].clicked&&(parseInt(POS[i].y+POS[i].el.height()/2)>($(window).height()-200)||(POS[i].y+POS[i].el.height()/2)<=200)){var that=POS[i].el.find(".active");if(that.length&&POS[i].active){POS[i].active=false;if(POS[i].el.attr("id")=="web-cam1"){that.parent().children("div.inactive").fadeIn(100);that.hide();}
else{var cHeight=that.parent().children("div.inactive").height();that.parent().children("div.active").css('top',(-1)*cHeight);that.parent().children("div.inactive").fadeIn(100);setTimeout(hideInactive,200,that);}}}
else if(i!=9&&!POS[i].clicked){var that=POS[i].el.find(".inactive");if(that.length&&!POS[i].active){POS[i].active=true;POS[i].clicked=true;if(POS[i].el.attr("id")=="web-cam1"){that.parent().children("div.active").fadeIn(100);that.hide();}
else{that.parent().children("div.active").css('top',(-1)*that.height());that.parent().children("div.active").fadeIn(100);setTimeout(hideActive,200,that);}}}}}
setTimeout(checkPos,350);}
filterResult=function(url){$.post(url,function(data){if(data.result){$filterResultsHolder.html("").hide();$filterResultsHolder.append(data.result);history.pushState('','Test',url);$filterResultsHolder.fadeIn('5000');}},'json').fail(function(){alert("error");})};initGallery=function(i1,i2,i3){var gallery=$('#'+i1).galleriffic({delay:3000,numThumbs:6,preloadAhead:40,enableTopPager:false,enableBottomPager:false,maxPagesToShow:7,imageContainerSel:'#'+i2,controlsContainerSel:'',captionContainerSel:'#'+i3,loadingContainerSel:'',renderSSControls:true,renderNavControls:true,playLinkText:'Play',pauseLinkText:'Pause',prevLinkText:'Previous',nextLinkText:'Next',nextPageLinkText:'Next &rsaquo;',prevPageLinkText:'&lsaquo; Prev',enableHistory:false,enableKeyboardNavigation:true,autoStart:false,syncTransitions:false,defaultTransitionDuration:1000,onSlideChange:undefined,onTransitionOut:undefined,onTransitionIn:undefined,onPageTransitionOut:function(callback){this.fadeTo('fast',0.0,callback);},onPageTransitionIn:function(){var prevPageLink=this.find('a.prev').css('visibility','hidden');var nextPageLink=this.find('a.next').css('visibility','hidden');if(this.displayedPage>0)
prevPageLink.css('visibility','visible');var lastPage=this.getNumPages()-1;if(this.displayedPage<lastPage)
nextPageLink.css('visibility','visible');this.fadeTo('fast',1.0);},onImageAdded:undefined,onImageRemoved:undefined});gallery.find('a.prev').click(function(e){gallery.previousPage();e.preventDefault();});gallery.find('a.next').click(function(e){gallery.nextPage();e.preventDefault();});var tmp=gallery.find('a.thumb');if(tmp.length<=1){$('.slideshow').css('padding','0');$('.caption-holder').css('padding','0');$('.navigation').css('padding','0');$('.navigation ul').hide();}}
function initGalleryPobeda(i1,i2,i3){$('div.navigation').css({'width':'640px','float':'left'});$('div.galcontent').css('display','block');var gallery=$('#'+i1).galleriffic({delay:3000,numThumbs:7,preloadAhead:40,enableTopPager:false,enableBottomPager:false,maxPagesToShow:7,imageContainerSel:'#'+i2,controlsContainerSel:'',captionContainerSel:'#'+i3,loadingContainerSel:'',renderSSControls:true,renderNavControls:true,playLinkText:'Play',pauseLinkText:'Pause',prevLinkText:'Previous',nextLinkText:'Next',nextPageLinkText:'Next &rsaquo;',prevPageLinkText:'&lsaquo; Prev',enableHistory:false,enableKeyboardNavigation:true,autoStart:false,syncTransitions:false,defaultTransitionDuration:1000,onSlideChange:undefined,onTransitionOut:undefined,onTransitionIn:undefined,onPageTransitionOut:function(callback){this.fadeTo('fast',0.0,callback);},onPageTransitionIn:function(){var prevPageLink=this.find('a.prev').css('visibility','hidden');var nextPageLink=this.find('a.next').css('visibility','hidden');if(this.displayedPage>0)
prevPageLink.css('visibility','visible');var lastPage=this.getNumPages()-1;if(this.displayedPage<lastPage)
nextPageLink.css('visibility','visible');this.fadeTo('fast',1.0);},onImageAdded:undefined,onImageRemoved:undefined});gallery.find('a.prev').click(function(e){gallery.previousPage();e.preventDefault();});gallery.find('a.next').click(function(e){gallery.nextPage();e.preventDefault();});}
CompanyNewsReady=function(){try{$(".gallery-holder").each(function(){initGallery($(this).find('.navigation').attr('id'),$(this).find('.slideshow').attr('id'),$(this).find('.caption-holder').attr('id'));});}
catch(e){}}
CompanyPressReady=function(){try{$(".gallery-holder").each(function(){initGallery($(this).find('.navigation').attr('id'),$(this).find('.slideshow').attr('id'),$(this).find('.caption-holder').attr('id'));});}
catch(e){}}
FeedbackReady=function(){}
ApartmentReady=function(){initTabs();drawCoord();initAllApt();loadPageApt();}
CenterElemsMobile=function(){var w2=Math.round($(window).width()/2);$("#web-cam").css("left",w2-348);$("#mats").css("left",w2+102);$("#public-zones").css("left",w2-468);$("#replica").css("left",w2+2);$("#view-from").css("left",w2-388);$("#intro").css("left",w2-368);$("#enviro").css("left",w2-468);$("#build-plan").css("left",w2+102);$("#floors").css("left",w2-468);}
PobedaReady=function(){if(isMobile.any()){$(window).resize(function(){CenterElemsMobile();});CenterElemsMobile();}
$('div.apartment').hide();setTimeout(checkPopup,300);$(".popup_inner").each(function(){$(this).css("height",$(window).height()-100);});$(".popup_inner .dragger_container").each(function(){$(this).css("height",$(this).parent().parent().height()-120);});$(".inactive").mouseover(function(){if(!$(this).hasClass('b-holder'))
return false;if(!okay&&cb==this.parentNode)
return false;cb=this.parentNode;okay=false;if($(this).find(".act-button a")){setClicked($(this).find(".act-button a"));blockOpen($(this).find(".act-button a"));setPOSActive($(this).find(".act-button a"));}
return false;});$(".active").mouseleave(function(){if(!$(this).hasClass('b-holder'))
return false;if(!okay&&cb==this.parentNode)
{$(this).mouseleave();return false;}
cb=this.parentNode;okay=false;if($(this).find(".act-button a")){setClicked($(this).find(".act-button a"));setPOSActive($(this).find(".act-button a"));blockClose($(this).find(".act-button a"));}
return false;});$(".b-holder").click(function(){var h=$(this).find("a").attr("href");window.location=h;});$("table.first a:last").addClass("active").removeAttr("href");$('html').mousemove(function(e){currentMouseHover=e.target;});initBlocks(false);clearPopups();var pobedacookie=getCookie('pobedabg');if(pobedacookie==1){$("#house-tab").addClass('ready');$("body").removeClass('loading');setTimeout("PobedaTimeoutStarter()",100);}
else{for(i=0;i<Drupal.settings.legenda.pobedabgtotal;i++){var img=new Image();img.onload=function(){pobedabgready++;if(pobedabgready>=Drupal.settings.legenda.pobedabgtotal){setCookie('pobedabg','1');setTimeout("PobedaTimeoutStarter()",1000);}}
img.src=Drupal.settings.legenda.pobedabg[i];}
if(isMobile.any()){var img=new Image();img.onload=function(){$("#house-tab").addClass('ready');};img.src=Drupal.settings.legenda.pobedawaiter;}}};PobedaDataPreloaderRdy1=function(){pobedabgready++;if(pobedabgready>=Drupal.settings.legenda.pobedabgtotal){if(isMobile.any()){var img=new Image();img.onload=PobedaDataPreloaderRdy2;img.src=Drupal.settings.legenda.pobedawaiter;}
else{setCookie('pobedabg','1');}}}
PobedaDataPreloaderRdy2=function(){setCookie('pobedabg','1');}
PobedaDataPreloader=function(){var pobedacookie=getCookie('pobedabg');if(pobedacookie!=1||1==1){for(i=0;i<Drupal.settings.legenda.pobedabgtotal;i++){var img=new Image();img.onload=PobedaDataPreloaderRdy1;img.src=Drupal.settings.legenda.pobedabg[i];}}}
PobedaTimeoutStarter=function(){if(isMobile.any()){$("body").removeClass('loading');$("#block-system-main").show();}
else{setTimeout("pStart()",100);}}
SmartReady=function(){$(".smart-plan").click(function(){$(".smart-link").css("display","none");var url=$(this).attr("href");filterResult(url);$(".smart-plans > a").removeClass("active").addClass("inactive");$(this).removeClass("inactive").addClass("active");return false;});$(".smart-link").click(function(){$(this).css("display","none");$("#smart-plans").html("");filterResult("/smart/s");$(".smart-plans > a").removeClass("active").addClass("inactive");$(".smart-plans > a:eq(0)").removeClass("inactive").addClass("active");return false;});$(".smart-plans > a").hover(function(){$(this).addClass("hover");},function(){$(this).removeClass("hover");});$filterResultsHolder=$("#smart-plans");};FrontSlideStarter=function(){setTimeout(function(){$('#slides').slides({effect:'fade',play:5000,paginationClass:'navigation',generatePagination:true,fadeSpeed:500,crossfade:true});},500);$('#slides').removeClass('loading');}
FrontPageReady=function(){var slidecookie=getCookie('frontslide');if(slidecookie==1&&1==0){$('#slides').removeClass('loading');FrontSlideStarter();}
else{for(i=0;i<Drupal.settings.legenda.frontslidestotal;i++){var img=new Image();img.onload=function(){frontslidesready++;if(frontslidesready>=Drupal.settings.legenda.frontslidestotal){setCookie('frontslide','1');FrontSlideStarter();}};img.src=Drupal.settings.legenda.frontslides[i];}}};SlidesReady=function(){if($("#slides-gal").length){$("#slides-gal").slides({generatePagination:false,generateNextPrev:true,effect:'fade'});}}
PobedaFlexsliderReady=function(){if($('#carousel').length>0){$('#carousel').flexslider({animation:"slide",itemWidth:99,itemMargin:1,controlNav:false,asNavFor:'#slides'});$('#slides').flexslider({sync:"#carousel",controlNav:false});}}
ColorboxReady=function(){if($(".section-english").length){$(".galery0").colorbox({rel:'galery0',scalePhotos:true,retinaImage:true,title:function(){var title=$(this).attr('value');return title;}});$(".galery1").colorbox({rel:'galery1',scalePhotos:true,retinaImage:true,title:function(){var title=$(this).attr('value');return title;}});$(".galery2").colorbox({rel:'galery2',scalePhotos:true,retinaImage:true,title:function(){var title=$(this).attr('value');return title;}});$(".galery3").colorbox({rel:'galery3',scalePhotos:true,retinaImage:true,title:function(){var title=$(this).attr('value');return title;}});$(".galery4").colorbox({rel:'galery4',scalePhotos:true,retinaImage:true,title:function(){var title=$(this).attr('value');return title;}});$(".galery5").colorbox({rel:'galery5',scalePhotos:true,retinaImage:true,title:function(){var title=$(this).attr('value');return title;}});$(".galery6").colorbox({rel:'galery6',scalePhotos:true,retinaImage:true,title:function(){var title=$(this).attr('value');return title;}});$(".galery7").colorbox({rel:'galery7',scalePhotos:true,retinaImage:true,title:function(){var title=$(this).attr('value');return title;}});}
if($('a.gallery').length>0){$('a.gallery').colorbox({rel:'gal'});}}
PreloadFonts=function(){$(".fontloader").addClass('ready');}
getCookie=function(name){var matches=document.cookie.match(new RegExp("(?:^|; )"+name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,'\\$1')+"=([^;]*)"))
return matches?decodeURIComponent(matches[1]):undefined}
setCookie=function(name,value,props){props=props||{}
var exp=props.expires
if(typeof exp=="number"&&exp){var d=new Date()
d.setTime(d.getTime()+exp*1000)
exp=props.expires=d}
if(exp&&exp.toUTCString){props.expires=exp.toUTCString()}
value=encodeURIComponent(value)
var updatedCookie=name+"="+value
for(var propName in props){updatedCookie+="; "+propName
var propValue=props[propName]
if(propValue!==true){updatedCookie+="="+propValue}}
document.cookie=updatedCookie}
deleteCookie=function(name){setCookie(name,null,{expires:-1})}
array_search=function(needle,haystack,argStrict){var strict=!!argStrict,key='';if(haystack&&typeof haystack==='object'&&haystack.change_key_case){return haystack.search(needle,argStrict);}
if(typeof needle==='object'&&needle.exec){if(!strict){var flags='i'+(needle.global?'g':'')+
(needle.multiline?'m':'')+
(needle.sticky?'y':'');needle=new RegExp(needle.source,flags);}
for(key in haystack){if(needle.test(haystack[key])){return key;}}
return false;}
for(key in haystack){if((strict&&haystack[key]===needle)||(!strict&&haystack[key]==needle)){return key;}}
return false;}
CombinedJSLoader=function(){$.cachedScript(Drupal.settings.legenda.jscombined.src).done(function(script,textStatus){liveTexStarter();doubleClickStarter();adhandsStarter();kavangaStarter();yaStarter();});}
$(document).ready(function(){alreadyrun.push('winload');currentUrl=((window.location+'').split('#').length>1)?(window.location+'').split('#')[0]:(window.location+'');var pobedafound=0;try{if(isMobile.any()){$('body').addClass('mobile');Drupal.settings.legenda.pobedabg=Drupal.settings.legenda.pobedamobilebg;Drupal.settings.legenda.pobedabgtotal=Drupal.settings.legenda.pobedamobilebgtotal;}
if(Drupal.settings.legenda.isfront){FrontPageReady();}else if(jQuery("#slides").length>0){FrontSlideStarter();}
if(Drupal.settings.legenda.exec&&$.isArray(Drupal.settings.legenda.exec)){for(elem in Drupal.settings.legenda.exec){funcname=Drupal.settings.legenda.exec[elem]+'Ready';if($.inArray(funcname,alreadyrun)==-1)
{if(Drupal.settings.legenda.exec[elem]=='Pobeda'){pobedafound=1;}
alreadyrun.push(funcname);eval(funcname+'()');}}}
if(pobedafound==0){setTimeout("PreloadFonts()",100);setTimeout("PobedaDataPreloader()",1000);}
if(Drupal.settings.legenda.auth==0){if(Drupal.settings.legenda.calltouch.pobeda){ga(function(tracker){(function(w,d,c){var a='all',b='tou';var src=b+'c'+'h';src='m'+'o'+'d.c'+a+src;$.getScript(('https:'==d.location.protocol?'https://':'http://')+src+"."+"r"+"u/d_client.js?param;specific_id2;client_id"+c+";ref"+escape(d.referrer)+";url"+escape(d.URL)+";cook"+escape(d.cookie)+";");})(window,document,tracker.get('clientId'));});$.getScript('http://track.auditorius.ru/pixel?id=30043&type=js');}}
setTimeout('CombinedJSLoader()',1000);}
catch(e)
{console.log('failed');console.log(e);}});}(jQuery));;
/* Source and licensing information for the above line(s) can be found at http://legenda-dom.ru/sites/all/themes/legenda_dom_ru/js/_primary.js. */
